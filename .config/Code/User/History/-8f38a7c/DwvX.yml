version: "3.8"
services:
  influxdb:
    image: influxdb:latest
    container_name: influxdb
    ports: 
      - "8086:8086"
    volumes:
      - influx-data:/var/lib/influxdb
    networks:
      - TICK-network
    environment: 
      DOCKER_INFLUXDB_INIT_MODE: setup
      DOCKER_INFLUXDB_INIT_USERNAME: admin
      DOCKER_INFLUXDB_INIT_PASSWORD: password
      DOCKER_INFLUXDB_INIT_ORG: sic
      DOCKER_INFLUXDB_INIT_BUCKET: tp2
      DOCKER_INFLUXDB_INIT_ADMIN_TOKEN: LRk4Qb4QtnFqdn83kYDG-1EXsNRkhFGrdZqJQhfy2IOTN7IIyVhWdwEu8PeKlvhXDHomucMZVOpE7tAPLSx0xQ==

  telegraf:
    image: telegraf:latest
    container_name: telegraf
    volumes:
     - ./TICK-stack/telegraf/telegraf.conf:/etc/telegraf/telegraf.conf
    networks:
     - TICK-network

  chronograf:
    image: chronograf:latest
    container_name: chronograf
    ports: 
      - "8888:8888"
    volumes: 
      - chronograf-data:/var/lib/chronograf
    networks:
      - TICK-network

  kapacitor:
    image: kapacitor:latest
    container_name: kapacitor
    volumes:
      - kapacitor-data:/var/lib/influxdb
      - ./TICK-stack/telegraf/kapacitor.conf:/etc/kapacitor/kapacitor.conf
    environment: 
      KAPACITOR_INFLUXDB_0_URLS_0: http://influxdb:8086
      KAPACITOR_INFLUXDB_ENABLED: true
      KAPACITOR_INFLUXDB_0_USERNAME: admin
      KAPACITOR_INFLUXDB_0_PASSWORD: password
    ports:
      - "9092:9092"
    networks:
      - TICK-network

volumes:
    telegraf-data:
      name: telegraf-data
      driver: local
    chronograf-data:
      name: chronograf-data
      driver: local
    influx-data:
      name: influx-data
      driver: local
    kapacitor-data:
      name: kapacitor-data
      driver: local

networks:
  TICK-network:
    name: TICK-network

